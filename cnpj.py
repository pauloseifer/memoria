#! /usr/bin/env python3

#
# O script funciona, mas o site acabou bloqueando.
# Provavelmente os sites utilizam API do Serpro para consulta, e ela é paga
#

from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.action_chains import ActionChains
from selenium.common.exceptions import NoSuchElementException
from selenium.webdriver.common.by import By
import time

CNPJs = [
#  "56940000283",
#  "80671000100",
#  "159074000175",
#  "175058000176",
#  "212727000132",
#  "337109000119",
#  "601731000192",
#  "648563000271",
#  "680868000180",
#  "763251000128",
#  "861664000145",
#  "923618000123",
#  "928542000129", 
#  "948721000128",
#  "1065934000174",
#  "1106849000107",
#  "1106849000379",
#  "1112137000109",
#  "1131231000105",
#  "1256679000147",
#  "1435328000101",
#  "1435328000284",
#  "1526764000188",
#  "1551272000908",
#  "1672342000382",
#  "1673330000100",
#  "1722958000310",
#  "1731676000118",
#  "1731676000207",
#  "1989828000187",
#  "2018294000104",
#  "2089969000530",
#  "2234575000102",
#  "2273805000134",
#  "2282742000182",
#  "2285042000141",
#  "2369784000155",
#  "2394154000130",
#  "2560231000347",
#  "2561851000139",
#  "2584218000166",
#  "2651052000153",
#  "2756351000152",
#  "2765094000115",
#  "2856265000111",
#  "2866758000302",
#  "3031839000185",
#  "3034075000181",
#  "3083850000270",
#  "3110407000160",
  "3439543000106",
  "3470626000400",
  "3612196000163",
  "3616325000191",
  "3680381000195",
  "3850952000192",
  "3902129001660",
  "3904956000106",
  "3904960000174",
  "3938789000386",
  "4016504000150",
  "4045715000111",
  "4171696000170",
  "4172183000183",
  "4253854000130",
  "4289264000168",
  "4355355000154",
  "4463344000279",
  "4480519000175",
  "4638429000160",
  "4642568000167",
  "4811676000116",
  "4814502000107",
  "4863480000175",
  "4863480000256",
  "4914597000130",
  "4918453000152",
  "4918453000314",
  "4918453000586",
  "4925217000163",
  "4967921000189",
  "4984884000117",
  "5047086000121",
  "5112520000100",
  "5119521000186",
  "5258189000130",
  "5270731000170",
  "5306715000190",
  "5369850000185",
  "5475305000173",
  "5491532000192",
  "5513750000180",
  "5517647000109",
  "5528196000539",
  "5679755000188",
  "5683277000937",
  "5765131000183",
  "5813465000185",
  "5927525000190",
  "5931635000126",
  "5979069000475",
  "6035964000151",
  "6040524000192",
  "6144922000159",
  "6293113000109",
  "6855894000188",
  "6881068000103",
  "6889621000154",
  "6942027000180",
  "7001973000194",
  "7053693003307",
  "7054279000135",
  "7081322000151",
  "7142723000174",
  "7398799000165",
  "7408801000130",
  "7464749000139",
  "7506529000120",
  "7522026000149",
  "7569161000220",
  "7572351000116",
  "7587853000110",
  "7611701000106",
  "7643660000130",
  "7710607000104",
  "7900888000168",
  "7915707000177",
  "7916152000501",
  "7927299000335",
  "7927729000238",
  "7927760000198",
  "7928029000187",
  "7937687000488",
  "7938069000100",
  "7938262000140",
  "7942926000145",
  "7943026000201",
  "7944839000127",
  "7948210000155",
  "7955071000197",
  "7957487000225",
  "7960427000180",
  "7962286000135",
  "7963266000855",
  "7971404000252",
  "7971407000296",
  "7974742000400",
  "7980127000163",
  "7980484000202",
  "7991507000284",
  "7991756000199",
  "7997942000135",
  "8002027000125",
  "8007218000180",
  "8007453000151",
  "8010139000128",
  "8016605000182",
  "8020168000170",
  "8024245000160",
  "8024988000130",
  "8024991000154",
  "8038387000349",
  "8040739000139",
  "8044443000358",
  "8060430000100",
  "8063714000150",
  "8063824000112",
  "8063830000250",
  "8064013000217",
  "8073792000136",
  "8076167000148",
  "8079848000160",
  "8083702000198",
  "8088092000115",
  "8090154000123",
  "8143803000107",
  "8144049000472",
  "8147012000155",
  "8152789000108",
  "8160465000111",
  "8163704000197",
  "8165754000103",
  "8185971000165",
  "8203763000141",
  "8206383000160",
  "8207643000112",
  "8212598000194",
  "8214514000151",
  "8220994000163",
  "8221229000249",
  "8232538000214",
  "8241158000165",
  "8251588000168",
  "8259476000234",
  "8267859000173",
  "8267859000254",
  "8275022000257",
  "8280589000130",
  "8285997000185",
  "8286773000198",
  "8301010000250",
  "8301024000273",
  "8305105000160",
  "8305105000241",
  "8305105000322",
  "8314849000141",
  "8320804000180",
  "8324156000482",
  "8338492000131",
  "8339105000181",
  "8358026000118",
  "8359780000172",
  "8369458000124",
  "8369748000178",
  "8370771000182",
  "8376798000182",
  "8376830000120",
  "8379509000360",
  "8397435000123",
  "8400380000163",
  "8409873000164",
  "8417590000407",
  "8421870000146",
  "8437422000211",
  "8437447000134",
  "8437459000673",
  "8445894000135",
  "8480315000195",
  "8484085000132",
  "8497655000129",
  "8500069000196",
  "8500468000157",
  "8503087000121",
  "8507799000119",
  "8525766000100",
  "8530615000131",
  "8536657000180",
  "8550385000172",
  "8550621000312",
  "8553341000449",
  "8555160000109",
  "8566833000126",
  "8567211000112",
  "8595952000107",
  "8616387000117",
  "8640804000167",
  "8672803000102",
  "8676079000187",
  "8681007000128",
  "8681007000470",
  "8696562000123",
  "8718386000183",
  "8724264000108",
  "8780345000117",
  "8780403000889",
  "8811226001903",
  "8820782000117",
  "8830664000190",
  "8832325000142",
  "8841296000185",
  "8851223000174",
  "8866010000388",
  "8881343000114",
  "8942375000182",
  "8950548000104",
  "9034982000107",
  "9103859000796",
  "9104133000344",
  "9119711000154",
  "9162847000147",
  "9175609000176",
  "9264950000106",
  "9264950000289",
  "9270460000104",
  "9271145000100",
  "9282370000214",
  "9336636000183",
  "9371795000119",
  "9371805000116",
  "9396966000245",
  "9397469000180",
  "9399257000132",
  "9413622000116",
  "9469143000111",
  "9479375000150",
  "9512677000183",
  "9592777000248",
  "9595849000120",
  "9627405000129",
  "10219082000113",
  "10227015000140",
  "10240100000149",
  "10251634000170",
  "10270995000164",
  "10293225000137",
  "10308447000186",
  "10318422000244",
  "10339017000121",
  "10425282003229",
  "10425282003490",
  "10425282003652",
  "10425282003903",
  "10425282004624",
  "10442129000103",
  "10477973000250",
  "10487237000100",
  "10563560000108",
  "10568281000137",
  "10589833000193",
  "10693132000108",
  "10693132000280",
  "10693132000361",
  "10731092000133",
  "10786889000138",
  "10796199000160",
  "10824810000116",
  "10896780000153",
  "10934664000181",
  "10959688000357",
  "10973333000150",
  "10978381000131",
  "11094287000182",
  "11094287000344",
  "11094287001073",
  "11266935000130",
  "11307281000227",
  "11323285000118",
  "11329990000122",
  "11383863000101",
  "11481756000116",
  "11491641000102",
  "11504992000100",
  "11511530000110",
  "11588888000141",
  "11636261000119",
  "11636261000208",
  "11681134000131",
  "11741240000163",
  "11845123000220",
  "11897624000170",
  "11990635000108",
  "12060994000110",
  "12208481000104",
  "12213443000140",
  "12254367000110",
  "12360287000140",
  "12360287000220",
  "12619302000121",
  "12662352000191",
  "12662352000353",
  "12804554000120",
  "12948970000100",
  "13068205000150",
  "13597348000150",
  "13685584000128",
  "13800133000194",
  "13814746000180",
  "13835927000193",
  "14042652000101",
  "14133509000117",
  "14158443000110",
  "14209815000190",
  "14234936000272",
  "14332037000121",
  "14659786000168",
  "14664074000137",
  "14732164000118",
  "14782568000116",
  "14906839000106",
  "15194191000147",
  "15348938000174",
  "15417629000109",
  "15574313000120",
  "15689185000160",
  "16422013000199",
  "16695068000172",
  "16777746000146",
  "16822377000166",
  "16849231000376",
  "16849231000619",
  "16849231001267",
  "16849231001429",
  "16849231001852",
  "16849231002239",
  "16964865000108",
  "16997028000347",
  "17122827000170",
  "17122967000149",
  "17134687000231",
  "17159518000175",
  "17223894000181",
  "17293029000101",
  "17322134000121",
  "17799898000102",
  "18095522000180",
  "18289838000102",
  "18637316000154",
  "18662931000110",
  "18664180000171",
  "18686727000130",
  "18996964000105",
  "19057724000108",
  "19275657000190",
  "19764271000303",
  "19834864000137",
  "19881029000158",
  "19964245000167",
  "20190636000150",
  "20340897000100",
  "20475773000131",
  "20525288000125",
  "21992946000151",
  "21992946005706",
  "22065048000110",
  "22699359000131",
  "22881003000203",
  "22906676000181",
  "22906677000126",
  "23344886000196",
  "23383802000123",
  "23386920000195",
  "23388571000140",
  "23393640000104",
  "23393646000181",
  "23483369000106",
  "23633375000518",
  "23708372000172",
  "23725339000150",
  "23944869000190",
  "24332655000125",
  "25006271000185",
  "25190420000109",
  "25650383000174",
  "26061314000198",
  "26073725000101",
  "26461699003600",
  "26461699009641",
  "26461699020700",
  "26461699022400",
  "26461699025507",
  "26461699044129",
  "26461699045524",
  "26651646000980",
  "26651646001951",
  "26657684000192",
  "27397406000106",
  "28634818000185",
  "28911052000139",
  "31804115000162",
  "31804115000243",
  "32069228000124",
  "32608107000103",
  "34454288000196",
  "35295483000183",
  "36047954000105",
  "36842169000136",
  "36891034000160",
  "37597457000135",
  "37658022000153",
  "39246143000113",
  "39787056000173",
  "39787056002389",
  "40039630000194",
  "42021220000141",
  "46232021000133",
  "46273757000150",
  "47067525019208",
  "48205157000180",
  "50290329002660",
  "50290329004876",
  "56814395000110",
  "56814395000382",
  "57069007001663",
  "62382726000193",
  "69616290000107",
  "72178650000132",
  "72223829000164",
  "72255276000121",
  "72327984000120",
  "73273526000119",
  "73417735000199",
  "73464026000164",
  "73562126000123",
  "73672412000141",
  "73936403000110",
  "74444258000113",
  "75404814000352",
  "75784140000105",
  "75904383006324",
  "75904383007053",
  "76108349000103",
  "76125244000162",
  "76531581000230",
  "77879971000188",
  "77879971001150",
  "77934503000169",
  "78269917000183",
  "78320397000196",
  "78597085000124",
  "79114450000912",
  "79416541000155",
  "79416541000589",
  "79863569000130",
  "80432693000120",
  "81124083000122",
  "81442014000167",
  "83011247002346",
  "83067942000114",
  "83067942000467",
  "83158824000111",
  "83158824005938",
  "83220723003149",
  "83305235002324",
  "83305235003649",
  "83305235005420",
  "83305235007806",
  "83305235008608",
  "83305235016970",
  "83731927004116",
  "84718741000100",
  "84718741000283",
  "84961473000145",
  "85667947000103",
  "85789782000142",
  "86512647002595",
  "87276721000450",
  "87455432000256",
  "87547188000170",
  "88587357000240",
  "88587357006604",
  "88612486000160",
  "88618285000412",
  "88668090000215",
  "88896899000466",
  "89096457004061",
  "89305239000507",
  "89677595002767",
  "89774160000797",
  "89844047000145",
  "90049156000150",
  "90058082000118",
  "90430414000143",
  "90657289000109",
  "91022632000101",
  "91022632000292",
  "91022632001426",
  "91023168000178",
  "91061036000130",
  "91156471004640",
  "91495549000150",
  "91589507000188",
  "91946657000100",
  "93305308000126",
  "93405934000194",
  "93607398000100",
  "94331634000170",
  "94541422000460",
  "94890266000109",
  "94890266000877",
  "95600227000184",
  "95821310000183",
  "97168033000187",
  "97320451000148",
  "97502322000170",
  "97506455000891",
  "97663728000135",
  "97663728000992",
  "98244577001620",
  "98338072003597",
  "763251000128",
  "7927341000156",
  "8000872000161",
  "8168604000315",
  "8168604000404",
  "8329830000179",
  "8381715000143",
  "8483887000128",
  "8591793000172",
  "10902048000149",
  "12441990000182",
  "12904697000104",
  "13228686000114",
  "50290329002660",
  "50290329004876",
  "97524218000268",
  "18517964000177",
  "2285042000141",
  "77917680005104",
  "2285042000141",
  "10255445000176"
]
# opcoes = webdriver.ChromeOptions()
# opcoes.add_argument("--headless")
# opcoes.add_argument("--window-size=1325x744")

# driver = webdriver.Firefox()
# driver = webdriver.Chrome("/home/pseifer/Downloads/chromedriver")

driver = webdriver.Chrome()
driver.get("https://www.google.com/")

cnpj = open("cnpj.csv", "a")
cnpj.write("CNPJ;Fantasia;Razao;Matriz;Situação\n")

for um in CNPJs: 
  driver.get("https://situacao-cadastral.com/")
  
  elemento = driver.find_element(By.XPATH, '/html/body/table/tbody/tr[1]/td/div/form/input[1]')
  elemento.send_keys(um)
  driver.find_element(By.XPATH, '/html/body/table/tbody/tr[1]/td/div/form/input[3]').click()

  CNPJ_Sistema = driver.find_element(By.XPATH, '/html/body/table/tbody/tr[2]/td/div[1]/span[1]').text
  Fantasia = driver.find_element(By.XPATH, '/html/body/table/tbody/tr[2]/td/div[1]/span[2]').text
  Razao = driver.find_element(By.XPATH, '/html/body/table/tbody/tr[2]/td/div[1]/span[3]/i').text
  Matriz = driver.find_element(By.XPATH, '/html/body/table/tbody/tr[2]/td/div[1]/span[5]/span').text
  Situacao = driver.find_element(By.XPATH, 'html/body/table/tbody/tr[2]/td/div[1]/span[6]/span').text

  print("CNPJ= ", CNPJ_Sistema)
  print("Fantasia= ", Fantasia)
  print("Razao= ", Razao)
  print("Matriz= ", Matriz)
  print("Situacao= ", Situacao)

  linha = ""
  linha = um+";"+CNPJ_Sistema+";"+Fantasia+Razao+";"+Matriz+"\n" #";"+Situacao+"\n"
  cnpj.write(linha)

cnpj.close()
driver.close()
